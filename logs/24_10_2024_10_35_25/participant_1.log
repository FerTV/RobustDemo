2024-10-24 10:35:29,385 - [NODE] Tracking CSV enabled
2024-10-24 10:35:29,386 - [NODE] Role: aggregator
2024-10-24 10:35:29,386 - [FedAvg] Initialization
2024-10-24 10:35:29,386 - [OBSERVABLE] Adding observer
2024-10-24 10:35:29,387 - [BASENODE] Node started
2024-10-24 10:35:29,387 - [OBSERVABLE] Adding observer
2024-10-24 10:35:29,387 - [OBSERVABLE] Adding observer
2024-10-24 10:35:49,388 - [OBSERVABLE] Adding observer
2024-10-24 10:35:49,389 - [BASENODE_connect_to] Connected to 192.168.50.2:45000 -> New neighbor 192.168.50.2:45000
2024-10-24 10:35:54,390 - [OBSERVABLE] Adding observer
2024-10-24 10:35:54,390 - [BASENODE_connect_to] Connected to 192.168.50.4:45000 -> New neighbor 192.168.50.4:45000
2024-10-24 10:35:54,391 - [NODE_CONNECTION] (NodeConnection Loop) Exception: [Errno 104] Connection reset by peer
2024-10-24 10:35:54,391 - [NODE_CONNECTION] Closed connection: 192.168.50.4:45000
2024-10-24 10:35:54,392 - [BASENODE.rm_neighbor] Remove neighbor: 192.168.50.4:45000
2024-10-24 10:35:59,391 - Neighbors: [<NodeConnection(node_connection-192.168.50.3:45000-192.168.50.2:45000, started 123377295558208)>]
2024-10-24 10:35:59,392 - Network nodes: ['192.168.50.2:45000', '192.168.50.4:45000', '192.168.50.3:45000']
2024-10-24 10:35:59,395 - [NODE.__gossip_model_difusion] Gossiping...
2024-10-24 10:35:59,439 - [NODE] Params received
2024-10-24 10:35:59,440 - [NODE] Initialization Model Weights
2024-10-24 10:35:59,442 - [NODE.__gossip_model_difusion] Initialization=True
2024-10-24 10:35:59,442 - ---------------------Feedback about neighbors---------------------
2024-10-24 10:35:59,443 - [NODE.__gossip_model] Neighbors: [<NodeConnection(node_connection-192.168.50.3:45000-192.168.50.2:45000, started 123377295558208)>]
2024-10-24 10:35:59,453 - ---------------------Feedback about neighbor node_connection-192.168.50.3:45000-192.168.50.2:45000---------------------
2024-10-24 10:35:59,453 - [NODE.__gossip_model] Neighbor: node_connection-192.168.50.3:45000-192.168.50.2:45000 | My __train_set: [] | Nc.modelsaggregated: []
2024-10-24 10:35:59,453 - [NODE.__gossip_model] Neighbor: node_connection-192.168.50.3:45000-192.168.50.2:45000 | Candidate_condition return: False
2024-10-24 10:35:59,453 - [NODE.__gossip_model] Neighbor: node_connection-192.168.50.3:45000-192.168.50.2:45000 | Status_function return: 192.168.50.2:45000
2024-10-24 10:35:59,453 - ---------------------End of feedback about neighbor node_connection-192.168.50.3:45000-192.168.50.2:45000---------------------
2024-10-24 10:35:59,453 - ------------------------------------------------------------------
2024-10-24 10:35:59,453 - [NODE.__gossip_model] Selected (to exclude) based on condition: []
2024-10-24 10:35:59,453 - [NODE] Gossip finished.
2024-10-24 10:36:09,395 - [NODE.__start_learning] Learning started in node 192.168.50.3:45000 -> Round: 0 | Epochs: 1
2024-10-24 10:36:09,396 - [Learner] Creating trainer with accelerator: cpu
2024-10-24 10:36:09,413 - [NODE.__train_step] __train_set = ['192.168.50.2:45000', '192.168.50.3:45000']
2024-10-24 10:36:09,413 - [NODE.__validate_train_set] Train set of 2 nodes: ['192.168.50.2:45000', '192.168.50.3:45000']
2024-10-24 10:36:09,413 - [NODE.__train_step] Role.AGGREGATOR/Role.SERVER process...
2024-10-24 10:36:09,414 - [NODE.__connect_and_set_aggregator] Aggregator set to: ['192.168.50.2:45000', '192.168.50.3:45000']
2024-10-24 10:36:09,414 - [NODE.__evaluate] Start evaluation...
2024-10-24 10:36:09,414 - [Learner] Creating trainer with accelerator: cpu
2024-10-24 10:36:11,735 - generated new fontManager
2024-10-24 10:36:12,540 - [NODE.__evaluate] Finish evaluation...
2024-10-24 10:36:12,540 - [NODE.__train] Start training...
2024-10-24 10:36:12,540 - [Learner] Creating trainer with accelerator: cpu
2024-10-24 10:36:20,288 - [NODE.__train] Finish training...
2024-10-24 10:36:20,289 - [NODE.__train_step] self.aggregator.add_model with MY MODEL
2024-10-24 10:36:20,289 - [Aggregator.add_model] Entry point
2024-10-24 10:36:20,289 - [Aggregator.add_model] Nodes who contributed to the model: ['192.168.50.3:45000']
2024-10-24 10:36:20,289 - [Aggregator] __aggregation_lock.acquire() during 300 seconds
2024-10-24 10:36:20,289 - [Aggregator.add_model] self.__models = dict_keys([])
2024-10-24 10:36:20,290 - [Aggregator.add_model] Adding model from nodes ['192.168.50.3:45000'] ||||| __train_set = ['192.168.50.2:45000', '192.168.50.3:45000'] | len(models_added) = 0
2024-10-24 10:36:20,290 - [Aggregator] Model added (1/2) from ['192.168.50.3:45000']
2024-10-24 10:36:20,290 - [Aggregator] Models for aggregation: dict_keys(['192.168.50.3:45000'])
2024-10-24 10:36:20,290 - [NODE.__train_step] self.broadcast with MODELS_AGGREGATED = MY_NAME
2024-10-24 10:36:20,290 - [NODE.__gossip_model_aggregation] Gossiping...
2024-10-24 10:36:20,290 - ---------------------Feedback about neighbors---------------------
2024-10-24 10:36:20,291 - [NODE.__gossip_model] Neighbors: [<NodeConnection(node_connection-192.168.50.3:45000-192.168.50.2:45000, started 123377295558208)>]
2024-10-24 10:36:20,291 - ---------------------Feedback about neighbor node_connection-192.168.50.3:45000-192.168.50.2:45000---------------------
2024-10-24 10:36:20,291 - [NODE.__gossip_model] Neighbor: node_connection-192.168.50.3:45000-192.168.50.2:45000 | My __train_set: ['192.168.50.2:45000', '192.168.50.3:45000'] | Nc.modelsaggregated: []
2024-10-24 10:36:20,291 - [NODE.__gossip_model] Neighbor: node_connection-192.168.50.3:45000-192.168.50.2:45000 | Candidate_condition return: True
2024-10-24 10:36:20,291 - [NODE.__gossip_model] Neighbor: node_connection-192.168.50.3:45000-192.168.50.2:45000 | Status_function return: ('192.168.50.2:45000', 0)
2024-10-24 10:36:20,291 - ---------------------End of feedback about neighbor node_connection-192.168.50.3:45000-192.168.50.2:45000---------------------
2024-10-24 10:36:20,291 - ------------------------------------------------------------------
2024-10-24 10:36:20,291 - [NODE.__gossip_model] Selected (to exclude) based on condition: [<NodeConnection(node_connection-192.168.50.3:45000-192.168.50.2:45000, started 123377295558208)>]
2024-10-24 10:36:20,291 - [NODE.__gossip_model] Selected a random subset of neighbors (to exclude): [<NodeConnection(node_connection-192.168.50.3:45000-192.168.50.2:45000, started 123377295558208)>]
2024-10-24 10:36:20,291 - [Aggregator] Getting partial aggregation from dict_keys(['192.168.50.3:45000']), except []
2024-10-24 10:36:20,292 - [FedAvg.aggregate] Aggregating models: num=1
2024-10-24 10:36:20,293 - [NODE] Gossiping model to 192.168.50.2:45000.
2024-10-24 10:36:20,293 - [NODE.__gossip_model] Building params message | Contributors: ['192.168.50.3:45000']
2024-10-24 10:36:20,294 - [NODE.__gossip_model] Sending params message to <NodeConnection(node_connection-192.168.50.3:45000-192.168.50.2:45000, started 123377295558208)>
2024-10-24 10:36:20,368 - [COMM_PROTOCOL.MODELS_AGGREGATED] Received models_aggregated message with ['192.168.50.3:45000']
2024-10-24 10:36:20,380 - [COMM_PROTOCOL.MODELS_AGGREGATED] Received models_aggregated message with ['192.168.50.2:45000']
2024-10-24 10:36:20,410 - [COMM_PROTOCOL.MODELS_AGGREGATED] Received models_aggregated message with ['192.168.50.3:45000', '192.168.50.2:45000', '192.168.50.4:45000']
2024-10-24 10:36:20,473 - [NODE] Params received
2024-10-24 10:36:20,474 - [NODE.add_model] Model received from ['192.168.50.2:45000', '192.168.50.4:45000'] --using--> __gossip_model_aggregation in the other node | Now I add the model using self.aggregator.add_model()
2024-10-24 10:36:20,476 - [Aggregator.add_model] Entry point
2024-10-24 10:36:20,476 - [Aggregator.add_model] Nodes who contributed to the model: ['192.168.50.2:45000', '192.168.50.4:45000']
2024-10-24 10:36:20,476 - [Aggregator.add_model] self.__models = dict_keys(['192.168.50.3:45000'])
2024-10-24 10:36:20,477 - [Aggregator.add_model] Adding model from nodes ['192.168.50.2:45000', '192.168.50.4:45000'] ||||| __train_set = ['192.168.50.2:45000', '192.168.50.3:45000'] | len(models_added) = 1
2024-10-24 10:36:20,477 - [Aggregator] Model added (3/2) from ['192.168.50.2:45000', '192.168.50.4:45000']
2024-10-24 10:36:20,477 - [Aggregator] Models for aggregation: dict_keys(['192.168.50.3:45000', '192.168.50.2:45000 192.168.50.4:45000'])
2024-10-24 10:36:20,477 - [Aggregator] __aggregation_lock.release() --> __models = dict_keys(['192.168.50.3:45000', '192.168.50.2:45000 192.168.50.4:45000'])
2024-10-24 10:36:20,477 - [NODE.add_model] self.broadcast with MODELS_AGGREGATED = ['192.168.50.3:45000', '192.168.50.2:45000', '192.168.50.4:45000']
2024-10-24 10:36:20,477 - [Aggregator] Aggregating models, timeout reached.
2024-10-24 10:36:20,487 - [Aggregator] __train_set=['192.168.50.2:45000', '192.168.50.3:45000'] || Missing models: {'192.168.50.2:45000'}
2024-10-24 10:36:20,488 - [FedAvg.aggregate] Aggregating models: num=2
2024-10-24 10:36:20,497 - [NODE.update] Override the local model with obj received
2024-10-24 10:36:20,497 - [NODE.__finish_aggregation_lock] __finish_aggregation_lock.release()
2024-10-24 10:36:21,291 - ---------------------Feedback about neighbors---------------------
2024-10-24 10:36:21,291 - [NODE.__gossip_model] Neighbors: [<NodeConnection(node_connection-192.168.50.3:45000-192.168.50.2:45000, started 123377295558208)>]
2024-10-24 10:36:21,291 - ---------------------Feedback about neighbor node_connection-192.168.50.3:45000-192.168.50.2:45000---------------------
2024-10-24 10:36:21,291 - [NODE.__gossip_model] Neighbor: node_connection-192.168.50.3:45000-192.168.50.2:45000 | My __train_set: ['192.168.50.2:45000', '192.168.50.3:45000'] | Nc.modelsaggregated: ['192.168.50.3:45000', '192.168.50.2:45000', '192.168.50.4:45000']
2024-10-24 10:36:21,291 - [NODE.__gossip_model] Neighbor: node_connection-192.168.50.3:45000-192.168.50.2:45000 | Candidate_condition return: False
2024-10-24 10:36:21,291 - [NODE.__gossip_model] Neighbor: node_connection-192.168.50.3:45000-192.168.50.2:45000 | Status_function return: ('192.168.50.2:45000', 3)
2024-10-24 10:36:21,291 - ---------------------End of feedback about neighbor node_connection-192.168.50.3:45000-192.168.50.2:45000---------------------
2024-10-24 10:36:21,291 - ------------------------------------------------------------------
2024-10-24 10:36:21,291 - [NODE.__gossip_model] Selected (to exclude) based on condition: []
2024-10-24 10:36:21,291 - [NODE] Gossip finished.
2024-10-24 10:36:21,292 - [FedAvg] Initialization
2024-10-24 10:36:21,292 - [OBSERVABLE] Adding observer
2024-10-24 10:36:21,292 - [NODE] Finalizing round: 0
2024-10-24 10:36:21,292 - [LightningLearner] Starting round: 1
2024-10-24 10:36:21,292 - [NODE] Round 1 of 3 finished.
2024-10-24 10:36:21,292 - [NODE.__train_step] __train_set = ['192.168.50.2:45000', '192.168.50.3:45000']
2024-10-24 10:36:21,292 - [NODE.__validate_train_set] Train set of 2 nodes: ['192.168.50.2:45000', '192.168.50.3:45000']
2024-10-24 10:36:21,292 - [NODE.__train_step] Role.AGGREGATOR/Role.SERVER process...
2024-10-24 10:36:21,292 - [NODE.__connect_and_set_aggregator] Aggregator set to: ['192.168.50.2:45000', '192.168.50.3:45000']
2024-10-24 10:36:21,292 - [NODE.__evaluate] Start evaluation...
2024-10-24 10:36:21,292 - [Learner] Creating trainer with accelerator: cpu
2024-10-24 10:36:22,374 - [NODE.__evaluate] Finish evaluation...
2024-10-24 10:36:22,375 - [NODE.__train] Start training...
2024-10-24 10:36:22,375 - [Learner] Creating trainer with accelerator: cpu
2024-10-24 10:36:29,900 - [COMM_PROTOCOL.MODELS_AGGREGATED] Received models_aggregated message with ['192.168.50.2:45000']
2024-10-24 10:36:29,913 - [NODE.__train] Finish training...
2024-10-24 10:36:29,913 - [NODE.__train_step] self.aggregator.add_model with MY MODEL
2024-10-24 10:36:29,914 - [Aggregator.add_model] Entry point
2024-10-24 10:36:29,914 - [Aggregator.add_model] Nodes who contributed to the model: ['192.168.50.3:45000']
2024-10-24 10:36:29,929 - [Aggregator] __aggregation_lock.acquire() during 300 seconds
2024-10-24 10:36:29,929 - [Aggregator.add_model] self.__models = dict_keys([])
2024-10-24 10:36:29,929 - [Aggregator.add_model] Adding model from nodes ['192.168.50.3:45000'] ||||| __train_set = ['192.168.50.2:45000', '192.168.50.3:45000'] | len(models_added) = 0
2024-10-24 10:36:29,929 - [Aggregator] Model added (1/2) from ['192.168.50.3:45000']
2024-10-24 10:36:29,929 - [Aggregator] Models for aggregation: dict_keys(['192.168.50.3:45000'])
2024-10-24 10:36:29,930 - [NODE.__train_step] self.broadcast with MODELS_AGGREGATED = MY_NAME
2024-10-24 10:36:29,930 - [NODE.__gossip_model_aggregation] Gossiping...
2024-10-24 10:36:29,930 - ---------------------Feedback about neighbors---------------------
2024-10-24 10:36:29,930 - [NODE.__gossip_model] Neighbors: [<NodeConnection(node_connection-192.168.50.3:45000-192.168.50.2:45000, started 123377295558208)>]
2024-10-24 10:36:29,930 - ---------------------Feedback about neighbor node_connection-192.168.50.3:45000-192.168.50.2:45000---------------------
2024-10-24 10:36:29,930 - [NODE.__gossip_model] Neighbor: node_connection-192.168.50.3:45000-192.168.50.2:45000 | My __train_set: ['192.168.50.2:45000', '192.168.50.3:45000'] | Nc.modelsaggregated: ['192.168.50.2:45000']
2024-10-24 10:36:29,930 - [NODE.__gossip_model] Neighbor: node_connection-192.168.50.3:45000-192.168.50.2:45000 | Candidate_condition return: True
2024-10-24 10:36:29,930 - [NODE.__gossip_model] Neighbor: node_connection-192.168.50.3:45000-192.168.50.2:45000 | Status_function return: ('192.168.50.2:45000', 1)
2024-10-24 10:36:29,930 - ---------------------End of feedback about neighbor node_connection-192.168.50.3:45000-192.168.50.2:45000---------------------
2024-10-24 10:36:29,930 - ------------------------------------------------------------------
2024-10-24 10:36:29,930 - [NODE.__gossip_model] Selected (to exclude) based on condition: [<NodeConnection(node_connection-192.168.50.3:45000-192.168.50.2:45000, started 123377295558208)>]
2024-10-24 10:36:29,930 - [NODE.__gossip_model] Selected a random subset of neighbors (to exclude): [<NodeConnection(node_connection-192.168.50.3:45000-192.168.50.2:45000, started 123377295558208)>]
2024-10-24 10:36:29,930 - [Aggregator] Getting partial aggregation from dict_keys(['192.168.50.3:45000']), except ['192.168.50.2:45000']
2024-10-24 10:36:29,931 - [FedAvg.aggregate] Aggregating models: num=1
2024-10-24 10:36:29,932 - [NODE] Gossiping model to 192.168.50.2:45000.
2024-10-24 10:36:29,934 - [NODE.__gossip_model] Building params message | Contributors: ['192.168.50.3:45000']
2024-10-24 10:36:29,935 - [NODE.__gossip_model] Sending params message to <NodeConnection(node_connection-192.168.50.3:45000-192.168.50.2:45000, started 123377295558208)>
2024-10-24 10:36:30,004 - [NODE] Params received
2024-10-24 10:36:30,005 - [NODE.add_model] Model received from ['192.168.50.2:45000'] --using--> __gossip_model_aggregation in the other node | Now I add the model using self.aggregator.add_model()
2024-10-24 10:36:30,007 - [Aggregator.add_model] Entry point
2024-10-24 10:36:30,007 - [Aggregator.add_model] Nodes who contributed to the model: ['192.168.50.2:45000']
2024-10-24 10:36:30,007 - [Aggregator.add_model] self.__models = dict_keys(['192.168.50.3:45000'])
2024-10-24 10:36:30,007 - [Aggregator.add_model] Adding model from nodes ['192.168.50.2:45000'] ||||| __train_set = ['192.168.50.2:45000', '192.168.50.3:45000'] | len(models_added) = 1
2024-10-24 10:36:30,007 - [Aggregator] Model added (2/2) from ['192.168.50.2:45000']
2024-10-24 10:36:30,007 - [Aggregator] Models for aggregation: dict_keys(['192.168.50.3:45000', '192.168.50.2:45000'])
2024-10-24 10:36:30,007 - [Aggregator] __aggregation_lock.release() --> __models = dict_keys(['192.168.50.3:45000', '192.168.50.2:45000'])
2024-10-24 10:36:30,008 - [NODE.add_model] self.broadcast with MODELS_AGGREGATED = ['192.168.50.3:45000', '192.168.50.2:45000']
2024-10-24 10:36:30,008 - [Aggregator] Aggregating models, timeout reached.
2024-10-24 10:36:30,008 - [Aggregator] Aggregating models.
2024-10-24 10:36:30,024 - [COMM_PROTOCOL.MODELS_AGGREGATED] Received models_aggregated message with ['192.168.50.2:45000', '192.168.50.4:45000']
2024-10-24 10:36:30,025 - [FedAvg.aggregate] Aggregating models: num=2
2024-10-24 10:36:30,039 - [NODE.update] Override the local model with obj received
2024-10-24 10:36:30,050 - [COMM_PROTOCOL.MODELS_AGGREGATED] Received models_aggregated message with ['192.168.50.2:45000', '192.168.50.4:45000', '192.168.50.3:45000']
2024-10-24 10:36:30,940 - ---------------------Feedback about neighbors---------------------
2024-10-24 10:36:30,940 - [NODE] Params received
2024-10-24 10:36:30,941 - [NODE.__gossip_model] Neighbors: [<NodeConnection(node_connection-192.168.50.3:45000-192.168.50.2:45000, started 123377295558208)>]
2024-10-24 10:36:30,941 - ---------------------Feedback about neighbor node_connection-192.168.50.3:45000-192.168.50.2:45000---------------------
2024-10-24 10:36:30,942 - [NODE.__gossip_model] Neighbor: node_connection-192.168.50.3:45000-192.168.50.2:45000 | My __train_set: ['192.168.50.2:45000', '192.168.50.3:45000'] | Nc.modelsaggregated: ['192.168.50.3:45000', '192.168.50.2:45000', '192.168.50.4:45000']
2024-10-24 10:36:30,942 - [NODE.__gossip_model] Neighbor: node_connection-192.168.50.3:45000-192.168.50.2:45000 | Candidate_condition return: False
2024-10-24 10:36:30,942 - [NODE.__gossip_model] Neighbor: node_connection-192.168.50.3:45000-192.168.50.2:45000 | Status_function return: ('192.168.50.2:45000', 3)
2024-10-24 10:36:30,942 - ---------------------End of feedback about neighbor node_connection-192.168.50.3:45000-192.168.50.2:45000---------------------
2024-10-24 10:36:30,942 - ------------------------------------------------------------------
2024-10-24 10:36:30,942 - [NODE.__gossip_model] Selected (to exclude) based on condition: []
2024-10-24 10:36:30,942 - [NODE] Gossip finished.
2024-10-24 10:36:30,942 - [FedAvg] Initialization
2024-10-24 10:36:30,943 - [NODE.add_model] Model received from ['192.168.50.4:45000'] --using--> __gossip_model_aggregation in the other node | Now I add the model using self.aggregator.add_model()
2024-10-24 10:36:30,943 - [OBSERVABLE] Adding observer
2024-10-24 10:36:30,943 - [NODE] Finalizing round: 1
2024-10-24 10:36:30,944 - [LightningLearner] Starting round: 2
2024-10-24 10:36:30,945 - [Aggregator.add_model] Entry point
2024-10-24 10:36:30,945 - [NODE] Round 2 of 3 finished.
2024-10-24 10:36:30,945 - [Aggregator.add_model] Nodes who contributed to the model: ['192.168.50.4:45000']
2024-10-24 10:36:30,945 - [NODE.__train_step] __train_set = ['192.168.50.2:45000', '192.168.50.3:45000']
2024-10-24 10:36:30,945 - [Aggregator.add_model] self.__models = dict_keys([])
2024-10-24 10:36:30,945 - [NODE.__validate_train_set] Train set of 2 nodes: ['192.168.50.2:45000', '192.168.50.3:45000']
2024-10-24 10:36:30,945 - [Aggregator.add_model] Adding model from nodes ['192.168.50.4:45000'] ||||| __train_set = [] | len(models_added) = 0
2024-10-24 10:36:30,945 - [NODE.__train_step] Role.AGGREGATOR/Role.SERVER process...
2024-10-24 10:36:30,945 - [NODE.__connect_and_set_aggregator] Aggregator set to: ['192.168.50.2:45000', '192.168.50.3:45000']
2024-10-24 10:36:30,945 - [NODE.__evaluate] Start evaluation...
2024-10-24 10:36:30,945 - [Learner] Creating trainer with accelerator: cpu
2024-10-24 10:36:31,985 - [NODE] Params received
2024-10-24 10:36:32,004 - [NODE.add_model] Model received from ['192.168.50.4:45000'] --using--> __gossip_model_aggregation in the other node | Now I add the model using self.aggregator.add_model()
2024-10-24 10:36:32,015 - [Aggregator.add_model] Entry point
2024-10-24 10:36:32,016 - [Aggregator.add_model] Nodes who contributed to the model: ['192.168.50.4:45000']
2024-10-24 10:36:32,016 - [Aggregator] __aggregation_lock.acquire() during 300 seconds
2024-10-24 10:36:32,016 - [Aggregator.add_model] self.__models = dict_keys([])
2024-10-24 10:36:32,017 - [Aggregator.add_model] Adding model from nodes ['192.168.50.4:45000'] ||||| __train_set = ['192.168.50.2:45000', '192.168.50.3:45000'] | len(models_added) = 0
2024-10-24 10:36:32,016 - [NODE.__evaluate] Finish evaluation...
2024-10-24 10:36:32,017 - [Aggregator] Model added (1/2) from ['192.168.50.4:45000']
2024-10-24 10:36:32,018 - [NODE.__train] Start training...
2024-10-24 10:36:32,018 - [Aggregator] Models for aggregation: dict_keys(['192.168.50.4:45000'])
2024-10-24 10:36:32,018 - [Learner] Creating trainer with accelerator: cpu
2024-10-24 10:36:32,019 - [NODE.add_model] self.broadcast with MODELS_AGGREGATED = ['192.168.50.4:45000']
2024-10-24 10:36:44,932 - [NODE.__train] Finish training...
2024-10-24 10:36:44,932 - [NODE.__train_step] self.aggregator.add_model with MY MODEL
2024-10-24 10:36:44,933 - [Aggregator.add_model] Entry point
2024-10-24 10:36:44,933 - [Aggregator.add_model] Nodes who contributed to the model: ['192.168.50.3:45000']
2024-10-24 10:36:44,933 - [Aggregator.add_model] self.__models = dict_keys(['192.168.50.4:45000'])
2024-10-24 10:36:44,933 - [Aggregator.add_model] Adding model from nodes ['192.168.50.3:45000'] ||||| __train_set = ['192.168.50.2:45000', '192.168.50.3:45000'] | len(models_added) = 1
2024-10-24 10:36:44,933 - [Aggregator] Model added (2/2) from ['192.168.50.3:45000']
2024-10-24 10:36:44,933 - [Aggregator] Models for aggregation: dict_keys(['192.168.50.4:45000', '192.168.50.3:45000'])
2024-10-24 10:36:44,933 - [Aggregator] __aggregation_lock.release() --> __models = dict_keys(['192.168.50.4:45000', '192.168.50.3:45000'])
2024-10-24 10:36:44,933 - [NODE.__train_step] self.broadcast with MODELS_AGGREGATED = MY_NAME
2024-10-24 10:36:44,933 - [Aggregator] Aggregating models, timeout reached.
2024-10-24 10:36:44,934 - [Aggregator] Aggregating models.
2024-10-24 10:36:44,934 - [NODE.__gossip_model_aggregation] Gossiping...
2024-10-24 10:36:44,934 - ---------------------Feedback about neighbors---------------------
2024-10-24 10:36:44,934 - [NODE.__gossip_model] Neighbors: [<NodeConnection(node_connection-192.168.50.3:45000-192.168.50.2:45000, started 123377295558208)>]
2024-10-24 10:36:44,934 - ---------------------Feedback about neighbor node_connection-192.168.50.3:45000-192.168.50.2:45000---------------------
2024-10-24 10:36:44,934 - [NODE.__gossip_model] Neighbor: node_connection-192.168.50.3:45000-192.168.50.2:45000 | My __train_set: ['192.168.50.2:45000', '192.168.50.3:45000'] | Nc.modelsaggregated: []
2024-10-24 10:36:44,934 - [NODE.__gossip_model] Neighbor: node_connection-192.168.50.3:45000-192.168.50.2:45000 | Candidate_condition return: True
2024-10-24 10:36:44,934 - [NODE.__gossip_model] Neighbor: node_connection-192.168.50.3:45000-192.168.50.2:45000 | Status_function return: ('192.168.50.2:45000', 0)
2024-10-24 10:36:44,934 - ---------------------End of feedback about neighbor node_connection-192.168.50.3:45000-192.168.50.2:45000---------------------
2024-10-24 10:36:44,935 - ------------------------------------------------------------------
2024-10-24 10:36:44,936 - [NODE.__gossip_model] Selected (to exclude) based on condition: [<NodeConnection(node_connection-192.168.50.3:45000-192.168.50.2:45000, started 123377295558208)>]
2024-10-24 10:36:44,936 - [FedAvg.aggregate] Aggregating models: num=2
2024-10-24 10:36:44,937 - [NODE.__gossip_model] Selected a random subset of neighbors (to exclude): [<NodeConnection(node_connection-192.168.50.3:45000-192.168.50.2:45000, started 123377295558208)>]
2024-10-24 10:36:44,938 - [Aggregator] Getting partial aggregation from dict_keys(['192.168.50.4:45000', '192.168.50.3:45000']), except []
2024-10-24 10:36:44,939 - [FedAvg.aggregate] Aggregating models: num=2
2024-10-24 10:36:44,946 - [NODE] Gossiping model to 192.168.50.2:45000.
2024-10-24 10:36:44,947 - [NODE.__gossip_model] Building params message | Contributors: ['192.168.50.4:45000', '192.168.50.3:45000']
2024-10-24 10:36:44,949 - [NODE.__gossip_model] Sending params message to <NodeConnection(node_connection-192.168.50.3:45000-192.168.50.2:45000, started 123377295558208)>
2024-10-24 10:36:44,960 - [NODE.update] Override the local model with obj received
2024-10-24 10:36:45,030 - [COMM_PROTOCOL.MODELS_AGGREGATED] Received models_aggregated message with ['192.168.50.4:45000', '192.168.50.3:45000']
2024-10-24 10:36:45,934 - ---------------------Feedback about neighbors---------------------
2024-10-24 10:36:45,935 - [NODE.__gossip_model] Neighbors: [<NodeConnection(node_connection-192.168.50.3:45000-192.168.50.2:45000, started 123377295558208)>]
2024-10-24 10:36:45,935 - ---------------------Feedback about neighbor node_connection-192.168.50.3:45000-192.168.50.2:45000---------------------
2024-10-24 10:36:45,935 - [NODE.__gossip_model] Neighbor: node_connection-192.168.50.3:45000-192.168.50.2:45000 | My __train_set: ['192.168.50.2:45000', '192.168.50.3:45000'] | Nc.modelsaggregated: ['192.168.50.3:45000', '192.168.50.4:45000']
2024-10-24 10:36:45,935 - [NODE.__gossip_model] Neighbor: node_connection-192.168.50.3:45000-192.168.50.2:45000 | Candidate_condition return: False
2024-10-24 10:36:45,935 - [NODE.__gossip_model] Neighbor: node_connection-192.168.50.3:45000-192.168.50.2:45000 | Status_function return: ('192.168.50.2:45000', 2)
2024-10-24 10:36:45,935 - ---------------------End of feedback about neighbor node_connection-192.168.50.3:45000-192.168.50.2:45000---------------------
2024-10-24 10:36:45,935 - ------------------------------------------------------------------
2024-10-24 10:36:45,935 - [NODE.__gossip_model] Selected (to exclude) based on condition: []
2024-10-24 10:36:45,935 - [NODE] Gossip finished.
2024-10-24 10:36:45,936 - [FedAvg] Initialization
2024-10-24 10:36:45,936 - [OBSERVABLE] Adding observer
2024-10-24 10:36:45,936 - [NODE] Finalizing round: 2
2024-10-24 10:36:45,936 - [LightningLearner] Starting round: 3
2024-10-24 10:36:45,936 - [NODE] Round 3 of 3 finished.
2024-10-24 10:36:45,936 - [NODE.__evaluate] Start evaluation...
2024-10-24 10:36:45,936 - [Learner] Creating trainer with accelerator: cpu
2024-10-24 10:36:47,170 - [COMM_PROTOCOL.MODELS_AGGREGATED] Received models_aggregated message with ['192.168.50.2:45000']
2024-10-24 10:36:47,426 - [NODE] Params received
2024-10-24 10:36:47,430 - [NODE.add_model] Model received from ['192.168.50.2:45000'] --using--> __gossip_model_aggregation in the other node | Now I add the model using self.aggregator.add_model()
2024-10-24 10:36:47,432 - [Aggregator.add_model] Entry point
2024-10-24 10:36:47,433 - [Aggregator.add_model] Nodes who contributed to the model: ['192.168.50.2:45000']
2024-10-24 10:36:47,433 - [Aggregator.add_model] self.__models = dict_keys([])
2024-10-24 10:36:47,433 - [Aggregator.add_model] Adding model from nodes ['192.168.50.2:45000'] ||||| __train_set = [] | len(models_added) = 0
2024-10-24 10:36:47,486 - [NODE.__evaluate] Finish evaluation...
2024-10-24 10:36:47,486 - [NODE] FL experiment finished | Round: 3 | Total rounds: 3 | [!] Both to None
2024-10-24 10:36:47,487 - [NODE] FL experiment finished | __stop_learning()
2024-10-24 10:36:47,487 - [NODE] Stopping learning
2024-10-24 10:36:47,487 - [FedAvg] Initialization
2024-10-24 10:36:47,487 - [OBSERVABLE] Adding observer
2024-10-24 10:36:47,487 - [NODE.__start_learning] Thread __start_learning finished in node 192.168.50.3:45000
2024-10-24 10:36:48,248 - [NODE] Params received
2024-10-24 10:36:48,248 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:36:49,239 - [NODE] Params received
2024-10-24 10:36:49,239 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:36:50,237 - [NODE] Params received
2024-10-24 10:36:50,237 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:36:51,212 - [NODE] Params received
2024-10-24 10:36:51,213 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:36:52,214 - [NODE] Params received
2024-10-24 10:36:52,214 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:36:53,215 - [NODE] Params received
2024-10-24 10:36:53,216 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:36:54,211 - [NODE] Params received
2024-10-24 10:36:54,211 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:36:55,210 - [NODE] Params received
2024-10-24 10:36:55,210 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:36:56,216 - [NODE] Params received
2024-10-24 10:36:56,216 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:36:57,209 - [NODE] Params received
2024-10-24 10:36:57,209 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:36:58,211 - [NODE] Params received
2024-10-24 10:36:58,211 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:36:59,207 - [NODE] Params received
2024-10-24 10:36:59,208 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:37:00,210 - [NODE] Params received
2024-10-24 10:37:00,210 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:37:01,214 - [NODE] Params received
2024-10-24 10:37:01,214 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:37:02,214 - [NODE] Params received
2024-10-24 10:37:02,214 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:37:03,209 - [NODE] Params received
2024-10-24 10:37:03,209 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:37:04,210 - [NODE] Params received
2024-10-24 10:37:04,211 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:37:05,208 - [NODE] Params received
2024-10-24 10:37:05,209 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:37:06,217 - [NODE] Params received
2024-10-24 10:37:06,217 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:37:07,212 - [NODE] Params received
2024-10-24 10:37:07,213 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:37:08,215 - [NODE] Params received
2024-10-24 10:37:08,215 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:37:09,216 - [NODE] Params received
2024-10-24 10:37:09,216 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:37:10,209 - [NODE] Params received
2024-10-24 10:37:10,209 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:37:11,208 - [NODE] Params received
2024-10-24 10:37:11,209 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:37:12,219 - [NODE] Params received
2024-10-24 10:37:12,219 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:37:13,208 - [NODE] Params received
2024-10-24 10:37:13,208 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:37:14,209 - [NODE] Params received
2024-10-24 10:37:14,209 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:37:15,213 - [NODE] Params received
2024-10-24 10:37:15,214 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:37:16,215 - [NODE] Params received
2024-10-24 10:37:16,215 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:37:17,216 - [NODE] Params received
2024-10-24 10:37:17,216 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:37:18,206 - [NODE] Params received
2024-10-24 10:37:18,206 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:37:19,211 - [NODE] Params received
2024-10-24 10:37:19,211 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:37:20,239 - [NODE] Params received
2024-10-24 10:37:20,239 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:37:21,222 - [NODE] Params received
2024-10-24 10:37:21,222 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:37:22,212 - [NODE] Params received
2024-10-24 10:37:22,212 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:37:23,208 - [NODE] Params received
2024-10-24 10:37:23,208 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:37:24,214 - [NODE] Params received
2024-10-24 10:37:24,215 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:37:25,222 - [NODE] Params received
2024-10-24 10:37:25,223 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:37:26,214 - [NODE] Params received
2024-10-24 10:37:26,215 - [NODE] Tried to add a model while learning is not running
2024-10-24 10:37:27,215 - [NODE] Params received
2024-10-24 10:37:27,215 - [NODE] Tried to add a model while learning is not running
